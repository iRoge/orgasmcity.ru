(function(){window.SizeInput=function(){SizeInput.init=function(container){if(container==null){container=$("body")}return $(".size-selector a",container).each(function(index,element){if($(element).data("size-input")){return}return new SizeInput(element)})};function SizeInput(element){this._element=$(element);this._element.data("size-input",this);this._size=this._element.data("size")||0;this._count=parseInt($(".size-selector__count",this._element).text());if(_.isNaN(this._count)){this._count=0}this._element.on("click",_.bind(this.show,this))}SizeInput.prototype._render=function(){var template;template=_.template('<form class="size-form tooltip-popup" style="display:none">\n  <table>\n    <thead>\n      <tr>\n        <th>Размер</th>\n        <th>Количество</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr>\n        <td class="text--primary"><%= size %></td>\n        <td>\n          <input type="text" class="counter" value="<%= count %>">\n        </td>\n      </tr>\n    </tbody>\n    <tfoot>\n      <tr>\n        <td>\n          <a class="button button--outline button--block js-hide">Отмена</a>\n        </td>\n        <td>\n          <a class="button button--primary button--block js-save">Сохранить</a>\n        </td>\n      </tr>\n    </tr>\n    </tfoot>\n  </table>\n</form>');this._element.append(template({size:this._size,count:this._count}));this._container=$("form.size-form",this._element);$(".js-save",this._container).on("click",_.bind(this.save,this));$(".js-hide",this._container).on("click",_.bind(this.clear,this));$(document).on("mouseup",function(_this){return function(event){if(!_this._element.is(event.target)&&_this._element.has(event.target).length===0){return _this.clear()}}}(this));return CountInput.init(this._container)};SizeInput.prototype.save=function(){var sizeIdentity;this._count=parseInt($(".counter",this._element).val());sizeIdentity=$(".size-selector__count",this._element);if(!sizeIdentity.length){sizeIdentity=$('<div class="size-selector__count">');this._element.prepend(sizeIdentity)}sizeIdentity.text(this._count);if(this._count===0){sizeIdentity.remove()}this._element.toggleClass("selected",this._count>0);return this.hide()};SizeInput.prototype.show=function(){if(!this._container){this._render()}return this._container.show()};SizeInput.prototype.clear=function(){$(".counter",this._container).val(this._count);return this.hide()};SizeInput.prototype.hide=function(){if(!this._container){return}return setTimeout(function(_this){return function(){return _this._container.hide()}}(this),0)};return SizeInput}()}).call(this);