(function(){var ShopsPage,extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty;ShopsPage=function(superClass){extend(ShopsPage,superClass);function ShopsPage(){return ShopsPage.__super__.constructor.apply(this,arguments)}ShopsPage.prototype.initialize=function(){this._mapContainer=$("#map .shop-map");return $('.tabs-item[data-target="#map"]').on("show",function(_this){return function(){return _this.showMap()}}(this))};ShopsPage.prototype.showMap=function(url){if(url==null){url="/shops/?show_map=y"}if(this._map){return}return $.ajax({method:"get",url:url,cache:false,contentType:"json",success:function(_this){return function(response){var i,index,len,ref,shop;_this._shops=[];ref=response.shops;for(index=i=0,len=ref.length;i<len;index=++i){shop=ref[index];shop.index=index;_this._shops.push(shop)}return _this._initMap()}}(this)})};ShopsPage.prototype._initMap=function(){return this._map=new window.GoogleMapView(this._mapContainer,{items:this._shops})};return ShopsPage}(_Page);window.Pages.register("shops",ShopsPage)}).call(this);